import{j as e,q as t,H as a,W as s,r as n,a as o,bD as r,E as i,X as l}from"./index-61faf58b.js";import{E as c}from"./el-message-box-f87b857a.js";import"./el-button-e6441f40.js";import"./el-input-dc0bf57b.js";import"./el-overlay-37f85d5d.js";const{t:g}=e(),u=e=>{const u=t({pageSize:10,currentPage:1,total:10,tableList:[],params:{...(null==e?void 0:e.defaultParams)||{}},loading:!0,currentRow:null}),d=a((()=>({...u.params,pageSize:u.pageSize,pageIndex:u.currentPage})));s((()=>u.currentPage),(()=>{w.getList()})),s((()=>u.pageSize),(()=>{1===u.currentPage||(u.currentPage=1),w.getList()}));const m=n(),p=n(),P=async()=>{await l();const e=o(m);return e||console.error("The table is not registered. Please use the register method to register"),e},v=async t=>{if(await((null==e?void 0:e.delListApi)&&(null==e?void 0:e.delListApi(t)))){i.success(g("common.delSuccess"));const e=(u.total%u.pageSize===t.length||1===u.pageSize)&&u.currentPage>1?u.currentPage-1:u.currentPage;u.currentPage=e,w.getList()}},w={getList:async()=>{var t;u.loading=!0;const a=await(null==e?void 0:e.getListApi(o(d)).finally((()=>{u.loading=!1})));a&&(u.tableList=r(a.data||{},null==e?void 0:e.response.list),u.total=r(a.data||{},null==(t=null==e?void 0:e.response)?void 0:t.total)||0)},setProps:async(e={})=>{const t=await P();null==t||t.setProps(e)},setColumn:async e=>{const t=await P();null==t||t.setColumn(e)},getSelections:async()=>{const e=await P();return(null==e?void 0:e.selections)||[]},setSearchParams:e=>{u.currentPage=1,u.params=Object.assign(u.params,{pageSize:u.pageSize,pageIndex:u.currentPage,...e}),w.getList()},delList:async(e,t,a=!0)=>{const s=await P();if(t){if(!(null==s?void 0:s.selections.length))return void i.warning(g("common.delNoData"))}else if(!u.currentRow)return void i.warning(g("common.delNoData"));a?c.confirm(g("common.delMessage"),g("common.delWarning"),{confirmButtonText:g("common.delOk"),cancelButtonText:g("common.delCancel"),type:"warning"}).then((async()=>{await v(e)})):await v(e)}};return(null==e?void 0:e.props)&&w.setProps(e.props),{register:(e,t)=>{m.value=e,p.value=o(t)},elTableRef:p,tableObject:u,methods:w}};export{u};
